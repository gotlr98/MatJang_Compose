package com.example.matjang_compose

import android.content.Context
import android.view.ViewGroup
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.height
import androidx.compose.runtime.*
import androidx.compose.ui.Modifier
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.unit.dp
import androidx.compose.ui.viewinterop.AndroidView
import com.kakao.vectormap.KakaoMap
import com.kakao.vectormap.KakaoMapReadyCallback
import com.kakao.vectormap.LatLng
import com.kakao.vectormap.MapLifeCycleCallback
import com.kakao.vectormap.MapView
import com.kakao.vectormap.camera.CameraUpdate
import com.kakao.vectormap.camera.CameraUpdateFactory
import java.lang.Exception


@Composable
fun MainMapView(
    modifier: Modifier,
    latitude: Double,
    longitude: Double,
){
    val context = LocalContext.current
    val mapView = remember { MapView(context) }

    AndroidView(
        modifier = modifier.fillMaxSize(),
        factory = { context ->
            mapView.apply {
                mapView.start(
                    object: MapLifeCycleCallback(){
                        override fun onMapDestroy() {
                        }

                        override fun onMapError(p0: Exception?) {
                        }
                    },
                    object: KakaoMapReadyCallback(){
                        override fun onMapReady(p0: KakaoMap) {
                            p0.moveCamera(
                                CameraUpdateFactory.newCenterPosition(
                                LatLng.from(
                                    latitude, longitude
                                )
                            ))

                        }

                        override fun getPosition(): LatLng {
                            return super.getPosition()
                        }
                    }
                )
            }
        }
    )
}